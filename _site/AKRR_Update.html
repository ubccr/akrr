<!DOCTYPE html>
<html lang="en">


<head>
  <meta charset="utf-8">
  <title>Application Kernel Remote Runner (AKRR) Install &rarr; Update</title>
  <link rel="icon" type="image/x-icon" href="/xdmod-jekyll-theme/assets/images/favicon.ico" />
  <link rel="stylesheet" type="text/css" href="/xdmod-jekyll-theme/assets/css/effervescence.css" />
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-44300156-3');
    ga('send', 'pageview');
  </script>
</head>
<body>
  <div id="page-container">
    <div id="page-header">
      <a href="http://open.xdmod.org"><img src="/xdmod-jekyll-theme/assets/images/xdmod_logo.png" alt="XDMoD" /></a>
      <span class="maintitle">Application Kernel Remote Runner (AKRR) Module 2.1.1</span>
    </div>
    
    <div id="page-body">
      <div class="clear"></div>
      <div id="page-menu">
          <div class="page-menu-toc">
        
            
                <h2>About</h2>
                
                    <ul>
                    
                            
                            <li ><a href="/">Overview</a></li>
                            
                    
                    </ul>
                
            
                <h2>Download</h2>
                
                    <ul>
                    
                            
                            <li ><a href="/AKRR_Download.html">Download</a></li>
                            
                    
                    </ul>
                
            
                <h2>Install</h2>
                
                    <ul>
                    
                            
                            <li ><a href="/AKRR_Install.html">Install</a></li>
                            
                    
                            
                            <li class="active"><a href="/AKRR_Update.html">Update</a></li>
                            
                    
                    </ul>
                
            
                <h2>Using</h2>
                
                    <ul>
                    
                            
                            <li ><a href="/AKRR_Usage.html">Using</a></li>
                            
                    
                            
                            <li ><a href="/AKRR_Add_Resource.html">Adding New Resource</a></li>
                            
                    
                            
                            <li ><a href="/AKRR_Deployment_of_Application_Kernel_on_Resource.html">Adding Appkernel to Resource</a></li>
                            
                    
                            
                            <li ><a href="/AKRR_NAMD_Deployment.html">Adding NAMD</a></li>
                            
                    
                            
                            <li ><a href="/AKRR_HPCC_Deployment.html">Adding HPCC</a></li>
                            
                    
                            
                            <li ><a href="/AKRR_HPCG_Deployment.html">Adding HPCG</a></li>
                            
                    
                            
                            <li ><a href="/AKRR_IMB_Deployment.html">Adding IMB</a></li>
                            
                    
                            
                            <li ><a href="/AKRR_IOR_Deployment.html">Adding IOR</a></li>
                            
                    
                            
                            <li ><a href="/AKRR_MDTest_Deployment.html">Adding MDTest</a></li>
                            
                    
                            
                            <li ><a href="/AKRR_NWChem_Deployment.html">Adding NWChem</a></li>
                            
                    
                            
                            <li ><a href="/AKRR_GAMESS_Deployment.html">Adding GAMESS</a></li>
                            
                    
                            
                            <li ><a href="/AKRR_ENZO_Deployment.html">Adding ENZO</a></li>
                            
                    
                            
                            <li ><a href="/AKRR_Tasks_Scheduling.html">Scheduling Appkernels</a></li>
                            
                    
                            
                            <li ><a href="/AKRR_Walltimelimit_Setting.html">Setting AK Walltime</a></li>
                            
                    
                    </ul>
                
            
                <h2>Details</h2>
                
                    <ul>
                    
                            
                            <li ><a href="/AKRR_HowItWorks.html">How It Works</a></li>
                            
                    
                            
                            <li ><a href="/AKRR_Batch_Job_Script_Generation.html">Batch Job Script Generation</a></li>
                            
                    
                    </ul>
                
            
                <h2>Next</h2>
                
                    <ul>
                    
                            
                            <li ><a href="https://appkernels.xdmod.org/">xdmod-appkernels</a></li>
                            
                    
                    </ul>
                
            
        
    </div>
          
        
      </div>
      <div id="page-content">
         <h1>Install &rarr; Update</h1> 
        <h1 id="updating-from-akrr-10-to-akrr-21">Updating from AKRR-1.0 to AKRR-2.1</h1>

<p>There are significant differences between the new and old versions.
The update script will update the database, config files and move logs/outputs from appkernel runs.</p>

<blockquote>
  <p>Most of developmental version in-between AKRR-1.0 to AKRR-2.0 should be able to update with these instructions.</p>
</blockquote>

<h2 id="create-back-up-of-mysql-databases-strongly-recommended">Create Back-Up of MySQL Databases (Strongly Recommended)</h2>

<p>To be on safe side make a back-up of the AKRR databases:</p>

<p>```shell script
mysqldump â€“extended-insert=FALSE -u <user> -p mod_akrr| gzip -c &gt; mod_akrr_1.0.gz
mysqldump --extended-insert=FALSE -u <user> -p mod_appkernel| gzip -c &gt; mod_appkernel_1.0.gz</user></user></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## Rename Old AKRR Home directory

The update script will move updated configs and logs to new location. So if you want to keep AKRR in same directory rename old one:

```shell script
mv akrr akrr_old
</code></pre></div></div>

<h2 id="installation">Installation</h2>

<p>In the previous version AKRR was source installed. In this version RPM installation is recommended, 
in-source and using regular python methods are also possible.</p>

<p>The akrr update command should work for most combinations of older and newer installations.</p>

<h3 id="rpm-installation">RPM Installation</h3>
<p>Download RPM from https://github.com/ubccr/akrr/releases and install it:</p>

<p>```shell script
wget https://github.com/ubccr/akrr/releases/download/v2.1.1/akrr-2.1.1-1.noarch.rpm
sudo yum install akrr-2.1.1-1.noarch.rpm</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>

## Run Update Script

Run update script (as user which will run akrr, **don't use root** for that):

```shell script
akrr -vv update --akrr-home=&lt;New AKRR Home, default is ~/akrr&gt; --old-akrr-home=&lt;Old AKRR Home&gt;
</code></pre></div></div>
<blockquote>
  <ul>
    <li>
      <p>The new AKRR home should be different from the old one</p>
    </li>
    <li>
      <p>If you ran many appkernels in past it can take some time, extra verbose arguments <code class="language-plaintext highlighter-rouge">-vv</code> will help to 
understand what it is doing.</p>
    </li>
  </ul>
</blockquote>

<p>During update .bashrc could be modified to include new non-standard location of ARKK_HOME or akrr executable.
In this case to continue in same terminal session reload .bashrc:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">unset </span>AKRR_HOME
<span class="nb">source</span> .bashrc
</code></pre></div></div>

<p>At the end it will print recommended commands to run to finish update. The most important is to run:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>akrr resource deploy <span class="nt">--overwrite</span> <span class="nt">-r</span> &lt;resource&gt;
</code></pre></div></div>

<p>This will install new app kernel utilities. But be careful it will overwrites inputs, so keep a copy if you modified some.</p>

<p>The proper update of appkernels can be verified with running verificantion and test run command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>akrr app validate <span class="nt">-r</span> &lt;resource&gt; <span class="nt">-a</span> &lt;appkernel&gt; <span class="nt">-n</span> &lt;number of nodes&gt;
</code></pre></div></div>

<p>Now you can update the <a href="https://appkernels.xdmod.org/">xdmod-appkernels</a> module for Open XDMoD.
Most likely it was already done during xdmod update, as yum would not allow for xdmod update without simultaneous 
update of xdmod-appkernels.</p>

      </div>
      <div class="clear"></div>
    </div>
    <div id="page-footer">
      <a href="https://www.buffalo.edu/ccr" target="_blank"><img src="/xdmod-jekyll-theme/assets/images/ccr_logo.png" alt="Center for Computational Research"/></a>
    </div>
  </div>
</body>
</html>
